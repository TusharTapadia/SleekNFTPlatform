{"ast":null,"code":"var _jsxFileName = \"/Users/tushartapadia/Desktop/SleekNFT/src/components/Createcomponent.js\",\n    _s = $RefreshSig$();\n\nimport React, { useState, useEffect } from 'react';\nimport { useMoralis, useMoralisFile, useNewMoralisObject } from 'react-moralis';\nimport '../Create.css';\nimport { marketplaceContractAbi, tokenContractAbi } from '../abi.js';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst TOKEN_CONTRACT_ADDRESS = \"0x1B5A46fB6f0589b48184a1788Fc35d7E920fCEA9\";\nconst MARTKETPLACE_CONTRACT_ADDRESS = \"0xD09eEd06f09db762F181f37d354c4B6debf9fd31\";\n\nfunction Createcomponent() {\n  _s();\n\n  let statusValue;\n  const {\n    enableWeb3,\n    web3,\n    isAuthenticated,\n    user\n  } = useMoralis();\n  const {\n    save\n  } = useNewMoralisObject('Item');\n  const {\n    saveFile\n  } = useMoralisFile();\n  const [file, setFile] = useState('');\n  const [filename, setFilename] = useState(\"\");\n  const [price, setPrice] = useState(\"0\");\n  const [nftstatus, setNftstatus] = useState(\"Instant Buy\");\n  const [description, setDescription] = useState(\"\");\n  const tokenContract = new web3.eth.Contract(tokenContractAbi, TOKEN_CONTRACT_ADDRESS);\n  const marketplaceContract = new web3.eth.Contract(marketplaceContractAbi, MARTKETPLACE_CONTRACT_ADDRESS); // enableWeb3();\n\n  useEffect(() => {\n    if (isAuthenticated) {\n      enableWeb3();\n    }\n  }, [isAuthenticated]);\n\n  const onFileChange = event => {\n    if (event.target.files && event.target.files[0]) {\n      setFile(event.target.files[0]);\n    }\n  }; //  console.log(isWeb3Enabled);\n  //Create Item\n\n\n  const onCreateItem = async e => {\n    // const web3 = await Moralis.Web3.enable();\n    e.preventDefault(); //console.log(file);\n\n    const fileIpfs = await saveFile(\"nftFile.png\", file, {\n      saveIPFS: true\n    }); //console.log(fileIpfs);\n\n    const nftFilePath = fileIpfs._ipfs;\n    const nftFileHash = fileIpfs._hash; //console.log(nftFileHash,nftFilePath);\n\n    const metadata = {\n      name: filename,\n      description: description,\n      image: nftFilePath\n    };\n    const metadataFileIpfs = await saveFile(\"metadata.json\", {\n      base64: btoa(JSON.stringify(metadata))\n    }, {\n      saveIPFS: true\n    }); //console.log(metadataFileIpfs);\n\n    const nftFileMetaDataPath = metadataFileIpfs._ipfs;\n    const nftFileMetaDataHash = metadataFileIpfs._hash; //console.log(nftFileMetaDataHash,nftFileMetaDataPath);\n\n    const mintNft = async metadataUrl => {\n      const myWalletAddress = user.get('ethAddress');\n      const receipt = await tokenContract.methods.createItem(metadataUrl).send({\n        from: myWalletAddress\n      }); // const receipt = await tokenContract.methods.createItem(metadataUrl).send({from: myWalletAddress });\n      // console.log(receipt);\n\n      return receipt.events.Transfer.returnValues.tokenId;\n    };\n\n    const nftId = await mintNft(nftFileMetaDataPath);\n    await save({\n      'name': filename,\n      'description': description,\n      'nftFilePath': nftFilePath,\n      'nftFileHash': nftFileHash,\n      'nftFileMetaDataPath': nftFileMetaDataPath,\n      'nftFileMetaDataHash': nftFileMetaDataHash,\n      'nftId': nftId,\n      'nftContractAddress': TOKEN_CONTRACT_ADDRESS\n    });\n\n    switch (nftstatus) {\n      case \"notforsale\":\n        statusValue = \"0\";\n        break;\n\n      case \"instantbuy\":\n        statusValue = \"1\";\n        break;\n\n      case \"acceptoffers\":\n        statusValue = \"2\";\n        break;\n\n      default:\n        ;\n    }\n\n    console.log(nftstatus, statusValue);\n    const userAddress = await user.get('ethAddress');\n\n    switch (statusValue) {\n      case \"0\":\n        return;\n\n      case \"1\":\n        await ensureMarketplaceIsApproved(nftId, TOKEN_CONTRACT_ADDRESS);\n        await marketplaceContract.methods.addItemToMarket(nftId, TOKEN_CONTRACT_ADDRESS, price).send({\n          from: userAddress\n        });\n        break;\n\n      case \"2\":\n        console.log(\"Not yet supported!\");\n        return;\n\n      default:\n        return;\n    }\n\n    console.log(nftstatus);\n  };\n\n  const ensureMarketplaceIsApproved = async (tokenId, tokenAddress) => {\n    const userAddress = await user.get('ethAddress');\n    const contract = new web3.eth.Contract(tokenContractAbi, tokenAddress);\n    const approvedAddress = await contract.methods.getApproved(tokenId).call({\n      from: userAddress\n    });\n\n    if (approvedAddress !== MARTKETPLACE_CONTRACT_ADDRESS) {\n      await contract.methods.approve(MARTKETPLACE_CONTRACT_ADDRESS, tokenId).send({\n        from: userAddress\n      });\n    }\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"absolute left-96 top-16 bg-my-black-color w-3/6 h-56 my-10 rounded-lg\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"border-my-gold-color border-dashed border-2 h-5/6 mt-4 mx-4 rounded-lg text-center\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"p-3\",\n        children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n          className: \"bg-clip-text text-gradient bg-gradient-to-r from-primary to-secondary  text-2xl p-3\",\n          children: \"Upload File\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 136,\n          columnNumber: 14\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"bg-clip-text text-gradient bg-gradient-to-r from-primary to-secondary  text-lg p-3\",\n          children: \"PNG, GIF, WEBP, MP4 or MP3. Max 100mb\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 137,\n          columnNumber: 14\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"file\",\n          className: \"ml-34 text-my-gold-color\",\n          onChange: onFileChange\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 138,\n          columnNumber: 14\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 135,\n        columnNumber: 14\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 134,\n      columnNumber: 14\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"flex\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex flex-col py-20 w-72\",\n        children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n          className: \"text-my-black-color text-2xl py-1\",\n          children: \"Tiltle\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 144,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          className: \" placeholder-black rounded-lg py-1 px-1 border-b-2 outline-none\",\n          type: \"text\",\n          placeholder: \"e.g. \\\"Redeemable T-shirt with logo\\\" \",\n          value: filename,\n          onChange: e => setFilename(e.target.value)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 145,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"h1\", {\n          className: \"text-my-black-color text-2xl py-1\",\n          children: \"Price\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 146,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          className: \"placeholder-black py-1 border-b-2 overflow-auto outline-none rounded-lg px-1 \",\n          value: price,\n          onChange: e => setPrice(e.target.value),\n          type: \"text\",\n          placeholder: \"Enter the price\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 147,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n          className: \"text-my-black-color text-2xl py-1\",\n          children: \"Status\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 148,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n          className: \"placeholder-my-black-color py-1 border-b-2 outline-none rounded-lg px-1 \",\n          value: nftstatus,\n          onChange: e => setNftstatus(e.target.value),\n          name: \"status\",\n          children: [/*#__PURE__*/_jsxDEV(\"option\", {\n            value: \"notforsale\",\n            children: \"Not For Sale\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 150,\n            columnNumber: 18\n          }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n            value: \"instantbuy\",\n            children: \"Instant Buy\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 151,\n            columnNumber: 18\n          }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n            value: \"acceptoffers\",\n            children: \"Accept Offers\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 152,\n            columnNumber: 18\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 149,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          type: \"submit\",\n          className: \"text-my-gold-color bg-my-black-color p-2 rounded-lg w-32 mt-6 mb-20  \",\n          onClick: onCreateItem,\n          children: \"Create\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 154,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 143,\n        columnNumber: 14\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex flex-col my-20 ml-40\",\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          className: \"text-my-black-color text-2xl py-1\",\n          children: \"Description\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 157,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"textarea\", {\n          cols: \"40\",\n          rows: \"7\",\n          placeholder: \"Description\",\n          className: \" placeholder-black border-b-2 overflow-auto outline-none rounded-lg px-1 \",\n          value: description,\n          onChange: e => setDescription(e.target.value)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 158,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 156,\n        columnNumber: 13\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 142,\n      columnNumber: 14\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 133,\n    columnNumber: 9\n  }, this);\n}\n\n_s(Createcomponent, \"l6Gx+dP2IazDqYibtPi16WZ1u9E=\", false, function () {\n  return [useMoralis, useNewMoralisObject, useMoralisFile];\n});\n\n_c = Createcomponent;\nexport default Createcomponent;\n\nvar _c;\n\n$RefreshReg$(_c, \"Createcomponent\");","map":{"version":3,"sources":["/Users/tushartapadia/Desktop/SleekNFT/src/components/Createcomponent.js"],"names":["React","useState","useEffect","useMoralis","useMoralisFile","useNewMoralisObject","marketplaceContractAbi","tokenContractAbi","TOKEN_CONTRACT_ADDRESS","MARTKETPLACE_CONTRACT_ADDRESS","Createcomponent","statusValue","enableWeb3","web3","isAuthenticated","user","save","saveFile","file","setFile","filename","setFilename","price","setPrice","nftstatus","setNftstatus","description","setDescription","tokenContract","eth","Contract","marketplaceContract","onFileChange","event","target","files","onCreateItem","e","preventDefault","fileIpfs","saveIPFS","nftFilePath","_ipfs","nftFileHash","_hash","metadata","name","image","metadataFileIpfs","base64","btoa","JSON","stringify","nftFileMetaDataPath","nftFileMetaDataHash","mintNft","metadataUrl","myWalletAddress","get","receipt","methods","createItem","send","from","events","Transfer","returnValues","tokenId","nftId","console","log","userAddress","ensureMarketplaceIsApproved","addItemToMarket","tokenAddress","contract","approvedAddress","getApproved","call","approve","value"],"mappings":"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","sourcesContent":["import React, {useState,useEffect} from 'react'\nimport { useMoralis, useMoralisFile,useNewMoralisObject} from 'react-moralis';\nimport '../Create.css';\nimport {marketplaceContractAbi, tokenContractAbi} from '../abi.js';\n\n\nconst TOKEN_CONTRACT_ADDRESS=\"0x1B5A46fB6f0589b48184a1788Fc35d7E920fCEA9\";\nconst MARTKETPLACE_CONTRACT_ADDRESS=\"0xD09eEd06f09db762F181f37d354c4B6debf9fd31\";\n\nfunction Createcomponent() {\n  let statusValue;\n    const{enableWeb3, web3,isAuthenticated,user}=useMoralis();\n    const { save } = useNewMoralisObject('Item');\n    const {saveFile} = useMoralisFile();\n    const [file, setFile] = useState('');\n    const [filename, setFilename] = useState(\"\");\n    const [price, setPrice] = useState(\"0\");\n    const [nftstatus, setNftstatus] = useState(\"Instant Buy\");\n    const [description, setDescription] = useState(\"\");\n\n    \n\n\n    const tokenContract = new web3.eth.Contract(tokenContractAbi, TOKEN_CONTRACT_ADDRESS);\n    const marketplaceContract = new web3.eth.Contract(marketplaceContractAbi, MARTKETPLACE_CONTRACT_ADDRESS);\n    // enableWeb3();\n    useEffect(() => {\n        if (isAuthenticated) {\n          enableWeb3();\n        }\n      },[isAuthenticated]);\n\n      \n    \n    const onFileChange = (event) => {\n        if (event.target.files && event.target.files[0]) {\n          setFile(event.target.files[0]);\n          \n        }\n       }\n      //  console.log(isWeb3Enabled);\n    \n    \n    \n    //Create Item\n       const onCreateItem = async (e) => {\n        // const web3 = await Moralis.Web3.enable();\n        e.preventDefault();\n            //console.log(file);\n            const fileIpfs= await saveFile(\"nftFile.png\",file,{\n             saveIPFS:true\n         });\n         //console.log(fileIpfs);\n             \n\n         const nftFilePath = fileIpfs._ipfs;\n        const nftFileHash=fileIpfs._hash;\n          \n      //console.log(nftFileHash,nftFilePath);\n          \n    const metadata = {\n        name: filename,\n        description: description,\n        image: nftFilePath,\n    };\n\n    const metadataFileIpfs= await saveFile(\"metadata.json\", {base64 : btoa(JSON.stringify(metadata))},{\n        saveIPFS:true\n    });\n    //console.log(metadataFileIpfs);\n     const nftFileMetaDataPath = metadataFileIpfs._ipfs;\n     const nftFileMetaDataHash = metadataFileIpfs._hash;\n     //console.log(nftFileMetaDataHash,nftFileMetaDataPath);\n     const mintNft = async (metadataUrl) => {\n      const myWalletAddress = user.get('ethAddress');\n        const receipt = await tokenContract.methods.createItem(metadataUrl).send({from: myWalletAddress });\n        // const receipt = await tokenContract.methods.createItem(metadataUrl).send({from: myWalletAddress });\n\n        // console.log(receipt);\n        return receipt.events.Transfer.returnValues.tokenId;\n    };\n     const nftId = await mintNft(nftFileMetaDataPath);\n     \n     await save({\n         'name':filename,\n         'description':description,\n         'nftFilePath':nftFilePath,\n         'nftFileHash':nftFileHash,\n         'nftFileMetaDataPath':nftFileMetaDataPath,\n         'nftFileMetaDataHash':nftFileMetaDataHash,\n         'nftId':nftId,\n         'nftContractAddress':TOKEN_CONTRACT_ADDRESS,\n        });\n        \n        switch(nftstatus){\n          case \"notforsale\":\n            statusValue=\"0\";\n              break;\n          case \"instantbuy\":\n            statusValue=\"1\";\n              break;\n          case \"acceptoffers\":\n            statusValue=\"2\";\n              break;\n          default: ;\n      }\n      console.log(nftstatus,statusValue);\n        const userAddress = await user.get('ethAddress');\n        switch(statusValue){\n          case \"0\":\n              return;\n          case \"1\":\n              await ensureMarketplaceIsApproved(nftId, TOKEN_CONTRACT_ADDRESS);\n              await marketplaceContract.methods.addItemToMarket(nftId, TOKEN_CONTRACT_ADDRESS, price).send({from: userAddress });\n              break;\n          case \"2\":\n              console.log(\"Not yet supported!\");\n              return;\n          default: return;\n      }\n       console.log(nftstatus);\n       }\n       const ensureMarketplaceIsApproved = async (tokenId, tokenAddress) => {\n        const userAddress = await user.get('ethAddress');\n        const contract = new web3.eth.Contract(tokenContractAbi, tokenAddress);\n        const approvedAddress = await contract.methods.getApproved(tokenId).call({from: userAddress});\n        if (approvedAddress !== MARTKETPLACE_CONTRACT_ADDRESS){\n            await contract.methods.approve(MARTKETPLACE_CONTRACT_ADDRESS,tokenId).send({from: userAddress});\n        }\n    }\n\n    return (\n        <div className=\"absolute left-96 top-16 bg-my-black-color w-3/6 h-56 my-10 rounded-lg\">\n             <div className=\"border-my-gold-color border-dashed border-2 h-5/6 mt-4 mx-4 rounded-lg text-center\">\n             <div className=\"p-3\">\n             <h1 className=\"bg-clip-text text-gradient bg-gradient-to-r from-primary to-secondary  text-2xl p-3\">Upload File</h1>\n             <p className=\"bg-clip-text text-gradient bg-gradient-to-r from-primary to-secondary  text-lg p-3\">PNG, GIF, WEBP, MP4 or MP3. Max 100mb</p>\n             <input type=\"file\" className=\"ml-34 text-my-gold-color\" onChange={onFileChange}/>\n             {/* <button type=\"submit\" className=\"text-my-black-color bg-gradient-to-r from-primary to-secondary  p-2 rounded-lg mt-1\" onClick={() => open files}>Choose file</button>  */}\n             </div>\n             </div>\n             <div className='flex'>\n             <div className=\"flex flex-col py-20 w-72\">\n            <h1 className=\"text-my-black-color text-2xl py-1\" >Tiltle</h1>\n            <input  className=\" placeholder-black rounded-lg py-1 px-1 border-b-2 outline-none\" type=\"text\" placeholder='e.g. \"Redeemable T-shirt with logo\" ' value={filename} onChange={(e) => setFilename(e.target.value)}/>\n            <h1  className=\"text-my-black-color text-2xl py-1\">Price</h1>\n            <input className=\"placeholder-black py-1 border-b-2 overflow-auto outline-none rounded-lg px-1 \" value={price} onChange={(e) => setPrice(e.target.value)} type=\"text\" placeholder='Enter the price'/>\n            <label className=\"text-my-black-color text-2xl py-1\" >Status</label>\n            <select className=\"placeholder-my-black-color py-1 border-b-2 outline-none rounded-lg px-1 \" value={nftstatus} onChange={(e) => setNftstatus(e.target.value)} name=\"status\">\n                 <option value=\"notforsale\">Not For Sale</option>\n                 <option value=\"instantbuy\">Instant Buy</option>\n                 <option value=\"acceptoffers\">Accept Offers</option>\n            </select>\n            <button type=\"submit\" className=\"text-my-gold-color bg-my-black-color p-2 rounded-lg w-32 mt-6 mb-20  \" onClick={onCreateItem} >Create</button>\n            </div>\n            <div className=\"flex flex-col my-20 ml-40\">\n            <label className=\"text-my-black-color text-2xl py-1\">Description</label>\n            <textarea cols=\"40\" rows=\"7\" placeholder=\"Description\"  className=\" placeholder-black border-b-2 overflow-auto outline-none rounded-lg px-1 \" value={description} onChange={(e) => setDescription(e.target.value)}/>\n            </div> \n            </div>\n            </div>\n    )\n}\n\nexport default Createcomponent\n\n\n\n\n\n"]},"metadata":{},"sourceType":"module"}